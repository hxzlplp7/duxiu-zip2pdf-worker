# ğŸš€ Cloudflareéƒ¨ç½²æŒ‡å—

## âš ï¸ é‡åˆ°çš„é—®é¢˜

éƒ¨ç½²æ—¶é‡åˆ°äº†ä¸€äº›é”™è¯¯ï¼Œå¯èƒ½æ˜¯ä»¥ä¸‹åŸå› ï¼š
- R2å­˜å‚¨æ¡¶éœ€è¦åœ¨Dashboardä¸­åˆ›å»º
- è´¦æˆ·èµ„æºé™åˆ¶
- wranglerç‰ˆæœ¬é—®é¢˜

## ğŸ“‹ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šé€šè¿‡Cloudflare Dashboardï¼ˆæ¨èï¼‰

#### 1. åˆ›å»ºR2å­˜å‚¨æ¡¶

1. è®¿é—® **https://dash.cloudflare.com/**
2. ç™»å½•ä½ çš„Cloudflareè´¦å·
3. åœ¨å·¦ä¾§èœå•é€‰æ‹© **R2**
4. ç‚¹å‡» **Create bucket**
5. è¾“å…¥åç§°ï¼š`duxiu-pdf-storage`
6. é€‰æ‹©ä½ç½®ï¼š**Automatic**ï¼ˆè‡ªåŠ¨ï¼‰
7. ç‚¹å‡» **Create bucket**

#### 2. åˆ›å»ºWorker

1. åœ¨å·¦ä¾§èœå•é€‰æ‹© **Workers & Pages**
2. ç‚¹å‡» **Create application**
3. é€‰æ‹© **Create Worker**
4. è¾“å…¥åç§°ï¼š`duxiu-zip2pdf-worker`
5. ç‚¹å‡» **Deploy**

#### 3. ä¸Šä¼ ä»£ç 

**é€‰é¡¹Aï¼šä½¿ç”¨Quick Edit**

1. åœ¨Workeré¡µé¢ç‚¹å‡» **Quick Edit**
2. åˆ é™¤é»˜è®¤ä»£ç 
3. å¤åˆ¶ `src/index.js` çš„æ‰€æœ‰å†…å®¹
4. ç²˜è´´åˆ°ç¼–è¾‘å™¨
5. ç‚¹å‡» **Save and Deploy**

**é€‰é¡¹Bï¼šä½¿ç”¨Wrangler CLI**

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•
cd d:\è¯»ç§€ç›®å½•åŠä½¿ç”¨å·¥å…·\duxiu-zip2pdf-worker

# éƒ¨ç½²
npx wrangler deploy
```

#### 4. ç»‘å®šR2å­˜å‚¨æ¡¶

1. åœ¨Workerè®¾ç½®é¡µé¢
2. é€‰æ‹© **Settings** æ ‡ç­¾
3. æ‰¾åˆ° **R2 Bucket Bindings**
4. ç‚¹å‡» **Add binding**
5. å¡«å†™ï¼š
   - Variable name: `BUCKET`
   - R2 bucket: `duxiu-pdf-storage`
6. ç‚¹å‡» **Save**
7. ç‚¹å‡» **Deploy**

#### 5. æµ‹è¯•

è®¿é—®ä½ çš„Worker URLï¼š
```
https://duxiu-zip2pdf-worker.ä½ çš„è´¦å·.workers.dev
```

### æ–¹æ³•äºŒï¼šä¿®å¤Wrangleré—®é¢˜åéƒ¨ç½²

#### 1. æ›´æ–°Wrangler

```bash
npm install --save-dev wrangler@latest
```

#### 2. æ£€æŸ¥wrangler.tomlé…ç½®

ç¡®ä¿æ–‡ä»¶å†…å®¹æ­£ç¡®ï¼š

```toml
name = "duxiu-zip2pdf-worker"
main = "src/index.js"
compatibility_date = "2024-12-01"

[[r2_buckets]]
binding = "BUCKET"
bucket_name = "duxiu-pdf-storage"
```

#### 3. æ‰‹åŠ¨åˆ›å»ºR2å­˜å‚¨æ¡¶

åœ¨Dashboardä¸­åˆ›å»ºï¼ˆè§æ–¹æ³•ä¸€æ­¥éª¤1ï¼‰

#### 4. é‡æ–°éƒ¨ç½²

```bash
npm run deploy
```

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### Q1: "Error: No such bucket"

**è§£å†³**ï¼š
1. åœ¨Dashboardä¸­æ‰‹åŠ¨åˆ›å»ºR2å­˜å‚¨æ¡¶
2. åç§°å¿…é¡»æ˜¯ `duxiu-pdf-storage`
3. ç­‰å¾…å‡ åˆ†é’Ÿåé‡è¯•

### Q2: "Error: Cannot read property 'BUCKET'"

**è§£å†³**ï¼š
1. æ£€æŸ¥R2ç»‘å®šæ˜¯å¦æ­£ç¡®
2. å˜é‡åå¿…é¡»æ˜¯ `BUCKET`ï¼ˆå¤§å†™ï¼‰
3. é‡æ–°éƒ¨ç½²Worker

### Q3: éƒ¨ç½²æˆåŠŸä½†è®¿é—®404

**è§£å†³**ï¼š
1. æ£€æŸ¥è·¯ç”±é…ç½®
2. è®¿é—®æ­£ç¡®çš„URLï¼š`https://xxx.workers.dev`
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### Q4: JavaScripté”™è¯¯

**è§£å†³**ï¼š
1. ç¡®ä¿ä»£ç ä¸­æ²¡æœ‰è¯­æ³•é”™è¯¯
2. æ£€æŸ¥ `node_modules` æ˜¯å¦æ­£ç¡®å®‰è£…
3. è¿è¡Œ `npm install` é‡æ–°å®‰è£…ä¾èµ–

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] Cloudflareè´¦å·å·²ç™»å½•
- [ ] R2å­˜å‚¨æ¡¶å·²åˆ›å»ºï¼ˆåç§°ï¼šduxiu-pdf-storageï¼‰
- [ ] Workerå·²åˆ›å»ºï¼ˆåç§°ï¼šduxiu-zip2pdf-workerï¼‰
- [ ] ä»£ç å·²ä¸Šä¼ 
- [ ] R2ç»‘å®šå·²é…ç½®ï¼ˆå˜é‡åï¼šBUCKETï¼‰
- [ ] Workerå·²é‡æ–°éƒ¨ç½²
- [ ] æµ‹è¯•é¡µé¢å¯è®¿é—®
- [ ] æ–‡ä»¶ä¸Šä¼ æµ‹è¯•é€šè¿‡
- [ ] PDFè½¬æ¢æµ‹è¯•é€šè¿‡

## ğŸ¯ éªŒè¯éƒ¨ç½²

### 1. è®¿é—®é¦–é¡µ

è®¿é—®ï¼š`https://ä½ çš„worker.workers.dev`

åº”è¯¥çœ‹åˆ°ï¼š
- ç²¾ç¾çš„ç´«è‰²æ¸å˜ç•Œé¢
- ä¸Šä¼ åŒºåŸŸ
- "æ”¯æŒè‡ªåŠ¨å¯†ç ç ´è§£"æç¤º

### 2. æµ‹è¯•ä¸Šä¼ 

1. å‡†å¤‡ä¸€ä¸ªå°çš„ZIPæ–‡ä»¶ï¼ˆ< 10MBï¼‰
2. ä¸Šä¼ 
3. ç‚¹å‡»"å¼€å§‹è½¬æ¢"
4. è§‚å¯Ÿè¿›åº¦
5. ä¸‹è½½PDF

### 3. æµ‹è¯•å¯†ç ç ´è§£

1. å‡†å¤‡ä¸€ä¸ªæœ‰å¯†ç çš„è¯»ç§€ZIP
2. ä¸Šä¼ ï¼ˆä¸è¾“å…¥å¯†ç ï¼‰
3. ç³»ç»Ÿè‡ªåŠ¨å°è¯•å¯†ç 
4. æˆåŠŸåæ˜¾ç¤ºä½¿ç”¨çš„å¯†ç 

## ğŸŒ è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

### 1. æ·»åŠ åŸŸå

1. Workerè®¾ç½® â†’ **Triggers**
2. ç‚¹å‡» **Add Custom Domain**
3. è¾“å…¥åŸŸåï¼ˆå¦‚ï¼špdf.example.comï¼‰
4. ç‚¹å‡» **Add Custom Domain**

### 2. DNSé…ç½®

Cloudflareä¼šè‡ªåŠ¨é…ç½®DNSï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

### 3. SSLè¯ä¹¦

è‡ªåŠ¨ç­¾å‘ï¼Œé€šå¸¸å‡ åˆ†é’Ÿå†…å®Œæˆã€‚

## ğŸ’° å…è´¹é¢åº¦æé†’

Cloudflare Workerså…è´¹ç‰ˆé™åˆ¶ï¼š
- **è¯·æ±‚æ•°**ï¼š100,000/å¤©
- **CPUæ—¶é—´**ï¼š10ms/è¯·æ±‚
- **æ‰§è¡Œæ—¶é—´**ï¼š30ç§’

R2å­˜å‚¨å…è´¹ç‰ˆé™åˆ¶ï¼š
- **å­˜å‚¨**ï¼š10GB
- **Aç±»æ“ä½œ**ï¼š100ä¸‡/æœˆ
- **Bç±»æ“ä½œ**ï¼š1000ä¸‡/æœˆ

**å»ºè®®**ï¼š
- å®šæœŸæ¸…ç†è¿‡æœŸæ–‡ä»¶
- ç›‘æ§ä½¿ç”¨é‡
- è¶…å‡ºæ—¶è€ƒè™‘ä»˜è´¹ç‰ˆ

## ğŸ”„ æ›´æ–°éƒ¨ç½²

ä¿®æ”¹ä»£ç åé‡æ–°éƒ¨ç½²ï¼š

```bash
# æäº¤ä»£ç 
git add .
git commit -m "Update: åŠŸèƒ½æ”¹è¿›"
git push

# éƒ¨ç½²
npm run deploy
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹å®æ—¶æ—¥å¿—

```bash
npm run tail
```

### åœ¨DashboardæŸ¥çœ‹

1. Workeré¡µé¢ â†’ **Logs**
2. é€‰æ‹©æ—¶é—´èŒƒå›´
3. æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…

### æ·»åŠ ç›‘æ§

1. Workerè®¾ç½® â†’ **Metrics**
2. æŸ¥çœ‹ï¼š
   - è¯·æ±‚æ•°
   - é”™è¯¯ç‡
   - CPUæ—¶é—´
   - å¸¦å®½ä½¿ç”¨

## ğŸŠ éƒ¨ç½²æˆåŠŸå

### 1. æ›´æ–°README

å°†Worker URLæ·»åŠ åˆ°READMEï¼š

```markdown
**åœ¨çº¿æ¼”ç¤º**: https://duxiu-zip2pdf-worker.xxx.workers.dev
```

### 2. åœ¨GitHubæ·»åŠ 

åœ¨ä»“åº“è®¾ç½®ä¸­ï¼š
- About â†’ Website â†’ å¡«å†™Worker URL

### 3. åˆ†äº«ç»™æœ‹å‹

å¯ä»¥åˆ†äº«çš„å†…å®¹ï¼š
- GitHubä»“åº“åœ°å€
- åœ¨çº¿æ¼”ç¤ºåœ°å€
- ä½¿ç”¨æ•™ç¨‹

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**
   ```bash
   npx wrangler tail
   ```

2. **æ£€æŸ¥CloudflareçŠ¶æ€**
   è®¿é—®ï¼šhttps://www.cloudflarestatus.com/

3. **æŸ¥çœ‹æ–‡æ¡£**
   - [Cloudflare Workersæ–‡æ¡£](https://developers.cloudflare.com/workers/)
   - [R2æ–‡æ¡£](https://developers.cloudflare.com/r2/)

4. **æäº¤Issue**
   åœ¨GitHubä»“åº“æäº¤é—®é¢˜æè¿°

## ğŸ¯ ä¸‹ä¸€æ­¥

éƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥ï¼š

- âœ… æµ‹è¯•å„ç§ZIPæ–‡ä»¶
- âœ… æµ‹è¯•å¯†ç ç ´è§£åŠŸèƒ½
- âœ… æ”¶é›†ç”¨æˆ·åé¦ˆ
- âœ… æ·»åŠ æ–°å¯†ç åˆ°åˆ—è¡¨
- âœ… ä¼˜åŒ–æ€§èƒ½
- âœ… æ·»åŠ æ–°åŠŸèƒ½

---

**é¢„ç¥éƒ¨ç½²æˆåŠŸï¼** ğŸš€

**é‡åˆ°é—®é¢˜éšæ—¶æŸ¥çœ‹æœ¬æŒ‡å—æˆ–æäº¤Issueï¼**
